<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>AddAdmin</title>
<!-- bootstrap CDN -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
<!-- jquery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script>
		$(document).ready(function(){
		    $('#adminId').focus();
  		    $('#adminId').blur() {
  		    	/*아이디 유효성검사*/
  		    	/*특수문자를 포함*/
  		    	var specialPattern = /^.*(?=.*[`~!@#$%^&*|\\\'\";:\/?]).*$/;
  		    	/*대문자, 소문자로 시작하는 7-16자 이내의 아이디*/
  		    	var checkId = /^[A-Za-z]{1}[A-Za-z0-9]{6,15}$/;
 		    	
 		    	if(specialPattern.test($('#adminId').val())){
 		    		$('#idHelper').text('아이디에 특수문자는 들어갈 수 없습니다');
	    			$('#adminId').focus();
		    	}else if(!checkId.test($('#adminId').val())){
		    		$('#idHelper').text('대문자, 소문자로 시작하고 7-16자 이내로 만들어주세요');
					$('#adminId').focus();
				} else {
					$('#idHelper').text('');
		    	}
		    });
		    /*아이디 중복검사*/
		    $('#idCheckBtn').click(function() {
		    	console.log('되랏ㅅㅅㅅㅅ');
		    	var isIdCheck = 0;
		    	$.ajax({
		    		async : true,
		    		url : '/adminIdCheck',
		    		method : 'POST',
		    		data : $('#adminId').val(),
		    		dataType : 'JSON',
		    		success : function(data){
		    			console.log('data 받아오기 성공');
						console.log(data + '<---countId');
						if(data != isIdCheck) {		// 아이디 중복
							idHelper.text('중복된 아이디입니다. 새로운 아이디를 만들어주세요');						
						} else if(data == isIdCheck) {		// 아이디 사용가능
							idHelper.text('사용 가능한 아이디 입니다');
						}
		    		},
		    		error: function(error) {					
						console.log("error: "+error);
					}
		    	});
		    });
		    $('#adminPw').blur() {
		    	/*비밀번호 유효성검사 : 5-20자 이내의 숫자,문자,특수문자를 포함한 비밀번호*/
		    	var checkPw = /^(?=.*[0-9])(?=.*[a-zA-Z])(?=.*?[#?!@$%^&*-]).{7,15}$/;
		    	
		    	if(!checkPw.test($('#adminPw').val())){
		    		$('#pwHelper').text('숫자, 문자, 특수문자를 포함하여 7-15자 이내로 만들어주세요');
		    		$('#adminPw').focus();
		    	} else {
		    		$('#pwHelper').text('');
		    	}
		    })
		    $('#adminName').blur() {
		    	/*이름 유효성검사 : 한글 혹은 영문 이름(띄어쓰기 가능)*/
  		    	var checkName=/^[가-힣a-zA-Z\s]+$/;
		    	
		    	if(!checkName.test($('#adminName').val())){
		    		$('#nameHelper').text('한글 혹은 영어로 정확히 입력해주세요');
		    		$('#adminName').focus();
		    	} else if($('#adminName').val().length < 2 || $('#adminName').val().length > 15){
		    		$('#nameHelper').text('2-15자 이내로 만들어주세요');
		    	}else {
		    		$('#nameHelper').text('');
		    	}
		    })
		    $('#submitBtn').click() {
                $('#addAdminForm').submit();
            });
		});
	</script>
</head>
<body>
	<h1>ADMIN INSERT</h1>
		<a href="/topAdmin/listAdmin">관리자 리스트</a>
		<form action="/topAdmin/addAdminAction" id="addAdminForm" method="post">
			<div>
				<label for="adminId">adminId</label>
				<input type="text" name="adminId" id="adminId">&nbsp;&nbsp;<input id="idCheckBtn" type="button">아이디 중복확인<br>
				<span id="idHelper"></span><br>
			</div>
			<div>
				<label for="adminPw">adminPw</label>
				<input type="text" name="adminPw" id="adminPw"><br>
				<span id="pwHelper"></span><br>
			</div>
			<div>
				<label for="adminName">adminName</label>
				<input type="text" name="adminName" id="adminName"><br>
				<span id="nameHelper"></span><br>
			</div>
			<button type="submit" id="submitBtn">등록</button>
		</form>
</body>
</html>